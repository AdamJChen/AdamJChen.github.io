---
title: "MQTT"
layout: post
---

I've been reading about a common communication protocol in IoT called MQTT, and I just wanted to summarize some things I've learned recently. 
It's commonly used in IoT because it's lightweight and it was designed for devices with limited resources or networks with limited bandwith. This is greate for IoT since it allows quick, real time message passing and many to many communications.
MQTT also has Quality of Service built into it unlike HTTP that requires the application layer to take care reliability of message delivery. This is handy for situations where a device might be located in a space with poor connectivity (Think agriculture applications).

### Protocol Architecture
Something about MQTT that I thought was pretty nifty was the Publish-Subscribe model. Unlike HTTP which is based on a client server message relationship, there's a "middle man" between communicating clients call the broker.
It's like two kids that have a crush on each other but are too shy to talk directly, so they have a a friend do all the note passing for them.
![Shy Kids](https://ahchealthenewscdn.azureedge.net/wp-content/uploads/2018/12/crush-505x329.jpg)
The two clients talking to each other can either be a publisher (sending messages) or a subscriber (reciving messages). This decoupling of the publisher and the subscriber means that they don't have to know about each other. Because of this, the scalability
of the application becomes simplifed. This is beneficial for systems that are connected to many devices, as messages are in a queue to be recieved rather than waiting on a specific server to be available. Moreover, because the broker is mediating message passing, messaging can now be asyncronous. This is good news for devices with intermittent connectivity. 
Even if the connection to the device is lost, the device is able to send the message to the broker when the connection has been reestablished. 
Here's a graphic of MQTT in action that I took from the [Wikipedia page](https://en.wikipedia.org/wiki/MQTT) for MQTT:
![MQTT diagram](https://upload.wikimedia.org/wikipedia/commons/thumb/8/82/MQTT_protocol_example_without_QoS.svg/1280px-MQTT_protocol_example_without_QoS.svg.png)
The image above reads from the top to the bottom (starting with connect). You can see that clients can act as both Subscribers and Publishers in this architecture.

### Quality of Service (QoS) Levels


### Last Will and Testament (LWT)
